/**
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 *  strict-local
 * @format
 */

'use strict';var _extends = Object.assign || function (target) {for (var i = 1; i < arguments.length; i++) {var source = arguments[i];for (var key in source) {if (Object.prototype.hasOwnProperty.call(source, key)) {target[key] = source[key];}}}return target;};let build = (() => {var _ref = _asyncToGenerator(









  function* (
  packagerClient,
  requestOptions)
  {
    const options = _extends({},
    Server.DEFAULT_BUNDLE_OPTIONS,
    requestOptions, {
      bundleType: 'ram' });

    return yield packagerClient.getRamBundleInfo(options);
  });return function build(_x, _x2) {return _ref.apply(this, arguments);};})();function _asyncToGenerator(fn) {return function () {var gen = fn.apply(this, arguments);return new Promise(function (resolve, reject) {function step(key, arg) {try {var info = gen[key](arg);var value = info.value;} catch (error) {reject(error);return;}if (info.done) {resolve(value);} else {return Promise.resolve(value).then(function (value) {step("next", value);}, function (err) {step("throw", err);});}}return step("next");});};}const Server = require('../../Server');const asAssets = require('./RamBundle/as-assets');const asIndexedFile = require('./RamBundle/as-indexed-file').save;

function save(
bundle,
options,
log)
{
  // we fork here depending on the platform:
  // while android is pretty good at loading individual assets, ios has a large
  // overhead when reading hundreds pf assets from disk
  /* $FlowFixMe(>=0.68.0 site=react_native_fb) This comment suppresses an error
   * found when Flow v0.68 was deployed. To see the error delete this comment
   * and run Flow. */
  return options.platform === 'android' && !options.indexedRamBundle ?
  asAssets(bundle, options, log) :
  asIndexedFile(bundle, options, log);
}

exports.build = build;
exports.save = save;
exports.formatName = 'bundle';